import System.IO
import Control.Monad
import Control.Applicative
import Data.Array
import Data.Word

data ProgState = ProgState { ptr     :: Int
    , vals    :: Array Int Word32
    , file    :: (String,String)    , loop_fl :: (String,String) }

ptr_right :: ProgState -> IO ProgState
ptr_right st = return (ProgState (ptr st + 1) (vals st) (cnsm_file_char st) (loop_fl st))

ptr_left :: ProgState -> IO ProgState
ptr_left st = return (ProgState (ptr st - 1) (vals st)(cnsm_file_char st) (loop_fl st))

val_incr :: ProgState -> IO ProgState
val_incr st = return (ProgState (ptr st) ((vals st)//[(ptr st,succ $ (vals st)!(ptr st))]) (cnsm_file_char st) (loop_fl st))

val_decr :: ProgState -> IO ProgState
val_decr st = return (ProgState (ptr st) ((vals st)//[(ptr st,pred $ (vals st)!(ptr st))]) (cnsm_file_char st) (loop_fl st))

val_prnt :: ProgState -> IO ProgState
val_prnt st = putChar ((toEnum . fromEnum) ((vals st)!(ptr st))) >> return (ProgState (ptr st) (vals st) (cnsm_file_char st) (loop_fl st))

val_inpt :: ProgState -> IO ProgState
val_inpt st = do { c <- getChar; return (ProgState (ptr st) ((vals st)//[(ptr st,(toEnum . fromEnum) c)]) (cnsm_file_char st) (loop_fl st)); }

nul_func :: ProgState -> IO ProgState
nul_func st = return (ProgState (ptr st) (vals st) (cnsm_file_char st) (loop_fl st))

end_loop :: ProgState -> IO ProgState
end_loop st = if (vals st)!(ptr st) == 0 then nul_func st else return (ProgState (ptr st) (vals st) (loop_fl st) (loop_fl st))

jmp_loop :: ProgState -> IO ProgState
jmp_loop st = do
    let c = (head . snd . file) st
    if c == (toEnum . fromEnum) ']'
        then end_loop st
        else nul_func st >>= jmp_loop

cnsm_file_char :: ProgState -> (String,String)
cnsm_file_char st = let f = file st in (fst f ++ [head (snd f)],tail (snd f))

beg_loop :: ProgState -> IO ProgState
beg_loop st = if (vals st)!(ptr st) == 0
        then jmp_loop st
        else return (ProgState (ptr st) (vals st)  (cnsm_file_char st) (cnsm_file_char st))
iost :: IO ProgState
iost = return (ProgState 0 (listArray (0,30000) (repeat 0))("","+++++ +++++             initialize counter (cell #0) to 10\n[                       use loop to set the next four cells to 70/100/30/10\n    > +++++ ++              add  7 to cell #1\n    > +++++ +++++           add 10 to cell #2 \n    > +++                   add  3 to cell #3\n    > +                     add  1 to cell #4\n    <<<< -                  decrement counter (cell #0)\n]                   \n> ++ .                  print 'H'\n> + .                   print 'e'\n+++++ ++ .              print 'l'\n.                       print 'l'\n+++ .                   print 'o'\n> ++ .                  print ' '\n<< +++++ +++++ +++++ .  print 'W'\n> .                     print 'o'\n+++ .                   print 'r'\n----- - .               print 'l'\n----- --- .             print 'd'\n> + .                   print '!'\n> .                     print '\\n'\n") ("","+++++ +++++             initialize counter (cell #0) to 10\n[                       use loop to set the next four cells to 70/100/30/10\n    > +++++ ++              add  7 to cell #1\n    > +++++ +++++           add 10 to cell #2 \n    > +++                   add  3 to cell #3\n    > +                     add  1 to cell #4\n    <<<< -                  decrement counter (cell #0)\n]                   \n> ++ .                  print 'H'\n> + .                   print 'e'\n+++++ ++ .              print 'l'\n.                       print 'l'\n+++ .                   print 'o'\n> ++ .                  print ' '\n<< +++++ +++++ +++++ .  print 'W'\n> .                     print 'o'\n+++ .                   print 'r'\n----- - .               print 'l'\n----- --- .             print 'd'\n> + .                   print '!'\n> .                     print '\\n'\n"))

main :: IO ()
main = do
    iost
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= (\st -> if (vals st)!(ptr st) /= 0
                  then beg_loop st
                  else jmp_loop st)

        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_left
        >>= ptr_left
        >>= ptr_left
        >>= ptr_left
        >>= nul_func
        >>= val_decr
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= end_loop
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_left
        >>= ptr_left
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_incr
        >>= val_incr
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= nul_func
        >>= val_decr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= nul_func
        >>= val_decr
        >>= val_decr
        >>= val_decr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_incr
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= ptr_right
        >>= nul_func
        >>= val_prnt
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func
        >>= nul_func